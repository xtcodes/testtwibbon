<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Twibbon | Memproses Foto</title>
<style>
/* 1. CSS Global dan Body */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center; 
    flex-direction: column;
    background-color: #f4f7f9; 
    color: #1f2937;
    padding: 20px;
}

/* 2. Area Pemrosesan Utama */
#processing-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 90%;
}

/* 3. Kontainer Tumpukan Pusat */
#central-stack {
    position: relative; 
    width: 80vmin;  /* Responsif berdasarkan viewport */
    max-width: 300px; 
    max-height: 300px;
    aspect-ratio: 1 / 1;
    margin-bottom: 30px;
}

/* 4. Kontainer Foto */
#preview-container {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 80%;    /* 80% dari #central-stack */
    height: 80%;
    border-radius: 50%;
    overflow: hidden;
    transform: translate(-50%, -50%);
    z-index: 3;
    background-color: #ffffff;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

#user-photo {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* 5. Spinner Layer 1: Bingkai Statis */
.spinner-frame {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 10% solid #cbd5e1; /* relatif terhadap ukuran container */
    box-sizing: border-box;
    z-index: 1;
}

/* 6. Spinner Layer 2: Lingkaran Berputar */
.spinner-outer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 10% solid transparent;
    border-top: 10% solid #10b981;
    animation: spin 1.5s linear infinite;
    box-sizing: border-box;
    z-index: 2; 
}

@keyframes spin {
    0% { transform: rotate(0deg); } 
    100% { transform: rotate(360deg); }
}

/* 7. Teks dan Tips */
h2 {
    color: #1f2937; 
    margin-bottom: 25px; 
    font-weight: 600; 
    font-size: 1.5em;
    text-align: center;
}

#processing-tips {
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 0.95em; 
    font-weight: 500; 
    color: #4b5563;
    text-align: center;
}

/* Responsif untuk layar kecil */
@media (max-width: 400px) {
    #central-stack {
        width: 90vw;
        max-width: 250px;
    }
}
</style>
</head>
<body>

<div id="processing-area">
    <h2>Sedang Memproses Foto Anda...</h2>

    <div id="central-stack">
        <div class="spinner-frame"></div> 
        <div class="spinner-outer"></div> 
        <div id="preview-container">
            <img id="user-photo" src="" alt="Foto Unggahan Pengguna">
        </div>
    </div>
    
    <div id="processing-tips">Memulai Pemrosesan...</div>
</div>
    
<script>
const tips = [
    "1/5: Mengambil bingkai twibbon default kami.",
    "2/5: Menganalisis resolusi foto Anda.",
    "3/5: Mengubah ukuran dan memotong gambar agar pas.",
    "4/5: Menyisipkan foto ke dalam bingkai twibbon.",
    "5/5: Menyelesaikan efek dan mengoptimalkan gambar."
];
let step = 0;
const totalSteps = tips.length;

document.addEventListener('DOMContentLoaded', function() {
    const photoDataURL = sessionStorage.getItem('uploadedPhoto');
    const userPhoto = document.getElementById('user-photo');

    if (!photoDataURL) {
        alert("Foto tidak ditemukan. Silakan unggah ulang.");
        window.location.href = 'index.html';
        return;
    }

    userPhoto.src = photoDataURL;
    startProcessingAnimation();
});

function startProcessingAnimation() {
    const tipsElement = document.getElementById('processing-tips');

    const intervalId = setInterval(() => {
        if (step < totalSteps) {
            tipsElement.textContent = tips[step];
            step++;
        } else {
            clearInterval(intervalId);
            setTimeout(() => {
                window.location.href = 'result.html';
            }, 1000);
        }
    }, 1500);
}
</script>
</body>
</html>
