<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Formatter HTML • CSS • JS</title>
  <style>
    :root {
      --bg: #f7f8fa;
      --text: #222;
      --muted: #666;
      --accent: #007bff;
      --border: #ddd;
    }
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 20px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1em;
    }
    h1 { margin: 0; font-size: 1.2em; }
    .tabs {
      display: flex;
      gap: 8px;
    }
    .tab {
      cursor: pointer;
      padding: 6px 12px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: white;
      color: var(--muted);
      font-weight: 500;
    }
    .tab.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    .card {
      background: white;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    label { font-size: 13px; color: var(--muted); }
    textarea {
      width: 100%;
      min-height: 180px;
      font-family: monospace;
      font-size: 13px;
      padding: 8px;
      margin-top: 6px;
      border: 1px solid var(--border);
      border-radius: 6px;
      resize: vertical;
    }
    .controls { margin-top: 8px; display: flex; gap: 8px; }
    button {
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid var(--border);
      cursor: pointer;
      background: var(--accent);
      color: white;
      font-weight: 500;
    }
    button.ghost {
      background: white;
      color: var(--muted);
    }
    .output {
      background: #f0f0f0;
      padding: 10px;
      border-radius: 6px;
      margin-top: 12px;
      min-height: 120px;
      font-family: monospace;
      font-size: 13px;
      white-space: pre-wrap;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <header>
    <h1>Formatter HTML • CSS • JS</h1>
    <div class="tabs">
      <div class="tab active" data-type="html">HTML</div>
      <div class="tab" data-type="css">CSS</div>
      <div class="tab" data-type="js">JS</div>
    </div>
  </header>

  <div class="card">
    <label id="labelTitle">HTML</label>
    <textarea id="inputArea" placeholder="Tempel kode di sini..."></textarea>
    <div class="controls">
      <button id="btnFormat">Format</button>
      <button id="btnCopy" class="ghost">Copy</button>
      <button id="btnDownload" class="ghost">Download</button>
    </div>
    <div class="output" id="output">Hasil format akan muncul di sini.</div>
  </div>

<script>
let currentTab = 'html';
const inputArea = document.getElementById('inputArea');
const output = document.getElementById('output');
const labelTitle = document.getElementById('labelTitle');
const tabs = document.querySelectorAll('.tab');
const storage = { html: '', css: '', js: '' };

function indent(level, size = 2){ return ' '.repeat(level * size); }

function formatHTML(input){
  input = input.trim();
  const wrapper = document.createElement('div');
  wrapper.innerHTML = input;
  function dump(node, level){
    const space = indent(level);
    let out = '';
    if (node.nodeType === Node.TEXT_NODE){
      const text = node.nodeValue.replace(/\s+/g,' ').trim();
      if(text) out += space + text + '\n';
      return out;
    }
    if (node.nodeType !== Node.ELEMENT_NODE) return out;
    const tag = node.tagName.toLowerCase();
    let open = '<' + tag;
    for(let a of node.attributes){ open += ' ' + a.name + '="' + a.value + '"'; }
    open += '>';
    const children = Array.from(node.childNodes).filter(n => !(n.nodeType===3 && !n.nodeValue.trim()));
    if(children.length===0){ out += space + open.replace(/>$/,'/>') + '\n'; }
    else {
      out += space + open + '\n';
      children.forEach(c => out += dump(c, level+1));
      out += space + '</' + tag + '>\n';
    }
    return out;
  }
  let res = '';
  wrapper.childNodes.forEach(n => res += dump(n,0));
  return res.trim();
}

function formatCSS(input, indentSize = 2){
  const ind = (lvl)=>' '.repeat(lvl*indentSize);
  let lvl=0, res='', buf='';
  for(let ch of input){
    buf += ch;
    if(ch=='{'){res += buf.trim()+'\n';lvl++;buf=ind(lvl);}
    else if(ch=='}'){lvl=Math.max(0,lvl-1);res=res.trimEnd()+'\n'+ind(lvl)+'}\n';buf=ind(lvl);}
    else if(ch==';'){res+=buf.trim()+'\n'+ind(lvl);buf='';}
  }
  res += buf.trim();
  return res.trim();
}

function formatJS(input, indentSize = 2){
  let out='',lvl=0,inStr=false,strChar='';
  for(let i=0;i<input.length;i++){
    const ch=input[i];
    if(!inStr && (ch==='"'||ch==="'"||ch==='`')){inStr=true;strChar=ch;out+=ch;continue;}
    if(inStr){out+=ch;if(ch===strChar && input[i-1]!=='\\')inStr=false;continue;}
    if(ch=='{'){lvl++;out+='{\n'+indent(lvl,indentSize);continue;}
    if(ch=='}'){lvl=Math.max(0,lvl-1);out+='\n'+indent(lvl,indentSize)+'}';continue;}
    if(ch==';'){out+=';\n'+indent(lvl,indentSize);continue;}
    out+=ch;
  }
  return out.trim();
}

document.getElementById('btnFormat').onclick = ()=>{
  const val = inputArea.value;
  if(!val.trim()){output.textContent='Tidak ada input.';return;}
  let formatted = val;
  try{
    if(currentTab==='html') formatted = formatHTML(val);
    if(currentTab==='css') formatted = formatCSS(val);
    if(currentTab==='js') formatted = formatJS(val);
  }catch(e){ formatted = 'Error: '+e.message; }
  storage[currentTab] = formatted;
  inputArea.value = formatted;
  output.textContent = formatted;
};

document.getElementById('btnCopy').onclick = ()=>{
  navigator.clipboard.writeText(inputArea.value).then(()=>alert('Disalin!'));
};

document.getElementById('btnDownload').onclick = ()=>{
  const blob = new Blob([inputArea.value], {type:'text/plain'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download=`formatted.${currentTab}`;
  a.click();
  URL.revokeObjectURL(a.href);
};

tabs.forEach(tab=>{
  tab.addEventListener('click', ()=>{
    tabs.forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    currentTab = tab.dataset.type;
    labelTitle.textContent = currentTab.toUpperCase();
    inputArea.value = storage[currentTab] || '';
    output.textContent = storage[currentTab] ? storage[currentTab] : 'Hasil format akan muncul di sini.';
  });
});
</script>
</body>
</html>
