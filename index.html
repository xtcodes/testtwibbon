<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Formatter HTML • CSS • JS</title>
  <style>
    :root {
      --bg: #f7f8fa;
      --text: #222;
      --muted: #666;
      --accent: #007bff;
      --border: #ddd;
    }
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 20px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1em;
    }
    h1 { margin: 0; font-size: 1.2em; }
    .tabs {
      display: flex;
      gap: 8px;
    }
    .tab {
      cursor: pointer;
      padding: 6px 12px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: white;
      color: var(--muted);
      font-weight: 500;
      user-select: none;
    }
    .tab.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    .card {
      background: white;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    label { font-size: 13px; color: var(--muted); }
    textarea {
      width: 100%;
      min-height: 180px;
      font-family: monospace;
      font-size: 13px;
      padding: 8px;
      margin-top: 6px;
      border: 1px solid var(--border);
      border-radius: 6px;
      resize: vertical;
    }
    .controls { margin-top: 8px; display: flex; gap: 8px; }
    button {
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid var(--border);
      cursor: pointer;
      background: var(--accent);
      color: white;
      font-weight: 500;
    }
    button.ghost {
      background: white;
      color: var(--muted);
    }
    .output {
      background: #f0f0f0;
      padding: 10px;
      border-radius: 6px;
      margin-top: 12px;
      min-height: 120px;
      font-family: monospace;
      font-size: 13px;
      white-space: pre-wrap;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <header>
    <h1>Formatter HTML • CSS • JS</h1>
    <div class="tabs">
      <div class="tab active" data-type="html">HTML</div>
      <div class="tab" data-type="css">CSS</div>
      <div class="tab" data-type="js">JS</div>
    </div>
  </header>

  <div class="card">
    <label id="labelTitle">HTML</label>
    <textarea id="inputArea" placeholder="Tempel kode di sini..."></textarea>
    <div class="controls">
      <button id="btnFormat">Format</button>
      <button id="btnCopy" class="ghost">Copy</button>
      <button id="btnDownload" class="ghost">Download</button>
    </div>
    <pre class="output" id="output">Hasil format akan muncul di sini.</pre>
  </div>

<script>
let currentTab = 'html';
const inputArea = document.getElementById('inputArea');
const output = document.getElementById('output');
const labelTitle = document.getElementById('labelTitle');
const tabs = document.querySelectorAll('.tab');
const storage = { html: '', css: '', js: '' };

// ===== FORMATTER VS CODE STYLE (2 SPASI) =====

// --- HTML ---
function formatHTML(input) {
  const tab = '  ';
  let indent = 0;
  return input
    .replace(/>\s+</g, '><')
    .replace(/</g, '~::~<')
    .split('~::~')
    .map((line) => {
      if (line.match(/^<\/\w/)) indent--;
      const pad = tab.repeat(indent);
      if (line.match(/^<\w[^>]*[^/]>/) && !line.includes('</')) indent++;
      return pad + line.trim();
    })
    .join('\n')
    .trim();
}

// --- CSS ---
function formatCSS(input) {
  const tab = '  ';
  let indent = 0;
  let formatted = '';
  input = input.replace(/\s*([\{\};])\s*/g, '$1').replace(/\s+/g, ' ').trim();

  for (let i = 0; i < input.length; i++) {
    const ch = input[i];
    if (ch === '{') {
      formatted += ' {\n';
      indent++;
      formatted += tab.repeat(indent);
    } else if (ch === '}') {
      indent--;
      formatted = formatted.trimEnd() + '\n' + tab.repeat(indent) + '}\n' + tab.repeat(indent);
    } else if (ch === ';') {
      formatted += ';\n' + tab.repeat(indent);
    } else {
      formatted += ch;
    }
  }
  return formatted.trim();
}

// --- JavaScript ---
function formatJS(input) {
  const tab = '  ';
  let indent = 0;
  let result = '';
  input = input.replace(/\s+/g, ' ').replace(/\s*([\{\};])\s*/g, '$1').trim();

  for (let i = 0; i < input.length; i++) {
    const ch = input[i];
    if (ch === '{') {
      result += ' {\n';
      indent++;
      result += tab.repeat(indent);
    } else if (ch === '}') {
      indent--;
      result = result.trimEnd() + '\n' + tab.repeat(indent) + '}\n' + tab.repeat(indent);
    } else if (ch === ';') {
      result += ';\n' + tab.repeat(indent);
    } else {
      result += ch;
    }
  }
  return result.trim();
}

// === EVENT HANDLERS ===
document.getElementById('btnFormat').onclick = () => {
  const val = inputArea.value;
  if (!val.trim()) {
    output.textContent = 'Tidak ada input.';
    return;
  }
  let formatted = val;
  try {
    if (currentTab === 'html') formatted = formatHTML(val);
    if (currentTab === 'css') formatted = formatCSS(val);
    if (currentTab === 'js') formatted = formatJS(val);
  } catch (e) {
    formatted = 'Error: ' + e.message;
  }
  storage[currentTab] = formatted;
  output.textContent = formatted; // hanya ubah preview, bukan textarea
};

document.getElementById('btnCopy').onclick = () => {
  navigator.clipboard.writeText(output.textContent).then(() => alert('Hasil format disalin!'));
};

document.getElementById('btnDownload').onclick = () => {
  const blob = new Blob([output.textContent], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `formatted.${currentTab}`;
  a.click();
  URL.revokeObjectURL(a.href);
};

tabs.forEach(tab => {
  tab.addEventListener('click', () => {
    tabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    currentTab = tab.dataset.type;
    labelTitle.textContent = currentTab.toUpperCase();
    inputArea.value = '';
    output.textContent = 'Hasil format akan muncul di sini.';
  });
});
</script>
</body>
</html>
